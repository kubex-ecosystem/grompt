@echo off
chcp 65001 >nul
setlocal enabledelayedexpansion

REM â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
REM â•‘                    ğŸš€ Grompt Setup                  â•‘
REM â•‘                                                              â•‘
REM â•‘              Script automÃ¡tico para Windows                 â•‘
REM â•‘                     Powered by Batch + Go                   â•‘
REM â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

set PROJECT_NAME=grompt
set PROJECT_VERSION=1.0.0
set AUTHOR_NAME=Grompt Team

echo.
echo â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
echo â•‘                    ğŸš€ Grompt Setup                  â•‘
echo â•‘                                                              â•‘
echo â•‘              Gerando estrutura completa do projeto          â•‘
echo â•‘                     Powered by Batch + Go                   â•‘
echo â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.

REM Check if Go is installed
echo ğŸ“¦ Verificando dependÃªncias...
where go >nul 2>&1
if errorlevel 1 (
    echo âŒ Go nÃ£o encontrado! Por favor, instale Go 1.21+ antes de continuar.
    echo ğŸ’¡ Baixe em: https://golang.org/dl/
    pause
    exit /b 1
)

REM Check if Node.js is installed
where node >nul 2>&1
if errorlevel 1 (
    echo âš ï¸  Node.js nÃ£o encontrado. Recomendamos instalar Node.js 16+
    echo ğŸ’¡ Baixe em: https://nodejs.org/
    echo ğŸ”„ Continuando sem Node.js - vocÃª pode instalar depois...
    set NODE_AVAILABLE=false
) else (
    echo âœ… Node.js encontrado
    set NODE_AVAILABLE=true
)

echo âœ… VerificaÃ§Ã£o de dependÃªncias concluÃ­da
echo.

REM Check if project directory already exists
if exist "%PROJECT_NAME%" (
    echo âŒ DiretÃ³rio '%PROJECT_NAME%' jÃ¡ existe!
    echo ğŸ§¹ Remova-o ou escolha outro nome.
    pause
    exit /b 1
)

echo ğŸ“ Criando estrutura do projeto...
mkdir "%PROJECT_NAME%"
cd "%PROJECT_NAME%"

REM Create frontend structure
mkdir frontend\src
mkdir frontend\public
mkdir .github\workflows

echo âœ… Estrutura de diretÃ³rios criada

echo ğŸ¹ Gerando arquivos Go...

REM Create main.go
(
echo package main
echo.
echo import ^(
echo 	"fmt"
echo 	"log"
echo 	"os"
echo 	"os/signal"
echo 	"syscall"
echo 	"time"
echo ^)
echo.
echo const ^(
echo 	AppName     = "Grompt"
echo 	AppVersion  = "1.0.0"
echo 	DefaultPort = "8080"
echo ^)
echo.
echo func main^(^) {
echo 	printBanner^(^)
echo.
echo 	// ConfiguraÃ§Ã£o
echo 	cfg := ^&Config{
echo 		Port:           getEnvOr^("PORT", DefaultPort^),
echo 		ClaudeAPIKey:   os.Getenv^("CLAUDE_API_KEY"^),
echo 		OllamaEndpoint: getEnvOr^("OLLAMA_ENDPOINT", "http://localhost:11434"^),
echo 	}
echo.
echo 	// Inicializar servidor
echo 	server := NewServer^(cfg^)
echo.
echo 	// Graceful shutdown
echo 	go func^(^) {
echo 		c := make^(chan os.Signal, 1^)
echo 		signal.Notify^(c, os.Interrupt, syscall.SIGTERM^)
echo 		^<-c
echo 		fmt.Println^("\nğŸ›‘ Encerrando servidor..."^)
echo 		server.Shutdown^(^)
echo 		os.Exit^(0^)
echo 	}^(^)
echo.
echo 	// Iniciar servidor
echo 	if err := server.Start^(^); err != nil {
echo 		log.Fatal^("âŒ Erro ao iniciar servidor:", err^)
echo 	}
echo }
echo.
echo func printBanner^(^) {
echo 	fmt.Printf^(`
echo â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
echo â•‘                    ğŸš€ %%s v%%s                    â•‘
echo â•‘                                                              â•‘
echo â•‘              Transforme ideias em prompts estruturados      â•‘
echo â•‘                     Powered by Go + React                   â•‘
echo â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo `, AppName, AppVersion^)
echo }
echo.
echo func getEnvOr^(key, defaultValue string^) string {
echo 	if value := os.Getenv^(key^); value != "" {
echo 		return value
echo 	}
echo 	return defaultValue
echo }
) > main.go

REM Create go.mod
(
echo module grompt
echo.
echo go 1.21
echo.
echo require ^(^)
) > go.mod

REM Create basic config.go
(
echo package main
echo.
echo type Config struct {
echo 	Port           string
echo 	ClaudeAPIKey   string
echo 	OllamaEndpoint string
echo 	Debug          bool
echo }
echo.
echo type APIConfig struct {
echo 	ClaudeAvailable bool   `json:"claude_available"`
echo 	OllamaAvailable bool   `json:"ollama_available"`
echo 	DemoMode        bool   `json:"demo_mode"`
echo 	Version         string `json:"version"`
echo }
echo.
echo func ^(c *Config^) GetAPIConfig^(^) *APIConfig {
echo 	return ^&APIConfig{
echo 		ClaudeAvailable: c.ClaudeAPIKey != "",
echo 		OllamaAvailable: false, // Simplified for Windows
echo 		DemoMode:        true,
echo 		Version:         AppVersion,
echo 	}
echo }
) > config.go

echo âœ… Arquivos Go bÃ¡sicos criados

if "%NODE_AVAILABLE%"=="true" (
    echo âš›ï¸  Criando arquivos React...
    
    REM Create package.json
    (
    echo {
    echo   "name": "grompt-frontend",
    echo   "version": "1.0.0",
    echo   "description": "Interface React para o Grompt",
    echo   "private": true,
    echo   "homepage": "./",
    echo   "dependencies": {
    echo     "lucide-react": "^0.263.1",
    echo     "react": "^18.2.0",
    echo     "react-dom": "^18.2.0",
    echo     "react-scripts": "5.0.1"
    echo   },
    echo   "scripts": {
    echo     "start": "react-scripts start",
    echo     "build": "react-scripts build",
    echo     "test": "react-scripts test",
    echo     "eject": "react-scripts eject"
    echo   },
    echo   "eslintConfig": {
    echo     "extends": ["react-app"]
    echo   },
    echo   "browserslist": {
    echo     "production": [">0.2%%", "not dead", "not op_mini all"],
    echo     "development": ["last 1 chrome version", "last 1 firefox version", "last 1 safari version"]
    echo   }
    echo }
    ) > frontend\package.json
    
    REM Create basic HTML
    (
    echo ^<!DOCTYPE html^>
    echo ^<html lang="pt-BR"^>
    echo ^<head^>
    echo   ^<meta charset="utf-8" /^>
    echo   ^<meta name="viewport" content="width=device-width, initial-scale=1" /^>
    echo   ^<title^>Grompt^</title^>
    echo   ^<script src="https://cdn.tailwindcss.com"^>^</script^>
    echo ^</head^>
    echo ^<body^>
    echo   ^<div id="root"^>^</div^>
    echo ^</body^>
    echo ^</html^>
    ) > frontend\public\index.html
    
    echo âœ… Arquivos React criados
) else (
    echo âš ï¸  Pulando criaÃ§Ã£o de arquivos React - Node.js nÃ£o disponÃ­vel
)

REM Create .gitignore
(
echo # BinÃ¡rios
echo grompt*
echo !grompt/
echo.
echo # Build outputs
echo build/
echo dist/
echo.
echo # Go
echo *.exe
echo *.dll
echo *.so
echo *.dylib
echo *.test
echo *.out
echo.
echo # Node.js
echo node_modules/
echo npm-debug.log*
echo.
echo # React
echo frontend/build/
echo.
echo # IDEs
echo .vscode/
echo .idea/
echo.
echo # OS
echo .DS_Store
echo Thumbs.db
echo.
echo # Logs
echo *.log
echo.
echo # Environment
echo .env
) > .gitignore

REM Create README.md
(
echo # ğŸš€ Grompt
echo.
echo ^> Transforme suas ideias brutas em prompts estruturados e profissionais
echo.
echo ## âœ¨ CaracterÃ­sticas
echo.
echo - ğŸ§  **Engenharia de Prompts Real** - Aplica tÃ©cnicas genuÃ­nas de prompt engineering
echo - âš›ï¸ **Interface React Moderna** - UI responsiva e intuitiva
echo - ğŸ¹ **Backend Go Robusto** - Servidor HTTP eficiente e leve
echo - ğŸ“¦ **BinÃ¡rio Ãšnico** - Zero dependÃªncias no deploy
echo - ğŸŒ **Multiplataforma** - Windows, Linux, macOS
echo.
echo ## ğŸš€ InÃ­cio RÃ¡pido
echo.
echo ### Windows
echo ```cmd
echo # 1. Instalar dependÃªncias ^(se npm disponÃ­vel^)
echo cd frontend
echo npm install
echo cd ..
echo.
echo # 2. Build Go
echo go mod tidy
echo go build -o grompt.exe .
echo.
echo # 3. Executar
echo grompt.exe
echo ```
echo.
echo ### Linux/macOS
echo ```bash
echo # 1. Instalar dependÃªncias
echo make install-deps
echo.
echo # 2. Build completo
echo make build-all
echo.
echo # 3. Executar
echo ./grompt
echo ```
echo.
echo ## âš™ï¸ ConfiguraÃ§Ã£o
echo.
echo ### VariÃ¡veis de Ambiente
echo.
echo ```cmd
echo # Windows
echo set CLAUDE_API_KEY=your_claude_api_key
echo set OLLAMA_ENDPOINT=http://localhost:11434
echo grompt.exe
echo ```
echo.
echo ```bash
echo # Linux/macOS
echo export CLAUDE_API_KEY=your_claude_api_key
echo export OLLAMA_ENDPOINT=http://localhost:11434
echo ./grompt
echo ```
echo.
echo ## ğŸ“„ LicenÃ§a
echo.
echo Este projeto estÃ¡ sob a licenÃ§a MIT.
echo.
echo ---
echo.
echo Feito com â¤ï¸ em Go + React
) > README.md

echo âœ… DocumentaÃ§Ã£o criada

echo ğŸ”§ Inicializando mÃ³dulos Go...
go mod tidy

if "%NODE_AVAILABLE%"=="true" (
    echo ğŸ“¦ Instalando dependÃªncias do frontend...
    cd frontend
    call npm install
    cd ..
    echo âœ… DependÃªncias instaladas
)

echo ğŸ¹ Testando build Go...
go build -o grompt-test.exe .

if exist "grompt-test.exe" (
    echo âœ… Build teste bem-sucedido!
    del grompt-test.exe
) else (
    echo âš ï¸  Build teste falhou, mas estrutura foi criada.
)

echo.
echo ğŸ‰ Projeto Grompt criado com sucesso!
echo.
echo ğŸ“ Estrutura criada em: .\%PROJECT_NAME%\
echo.
echo ğŸš€ PrÃ³ximos passos:
echo    1. cd %PROJECT_NAME%
echo    2. go build -o grompt.exe .
echo    3. grompt.exe
echo.
echo ğŸ”§ Para desenvolvimento completo:
echo    1. Instale Node.js 16+ (se ainda nÃ£o tiver)
echo    2. cd frontend ^&^& npm install ^&^& npm run build
echo    3. copy frontend\build\* .\
echo    4. go build -o grompt.exe .
echo.
echo ğŸ“š ConfiguraÃ§Ã£o de APIs:
echo    â€¢ set CLAUDE_API_KEY=your_key
echo    â€¢ set OLLAMA_ENDPOINT=http://localhost:11434
echo.
echo âœ… Estrutura completa gerada! Bom desenvolvimento! ğŸš€
echo.
pause