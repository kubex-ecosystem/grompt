"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[18],{18:(e,t,o)=>{o.d(t,{WU:()=>i,directCall:()=>l,hasByok:()=>n,streamDirectCall:()=>r});var a=o(2732);let n=(e,t)=>{var o,a,n,l,r,i,p;switch(e){case"openai":return!!(null==(o=t.openai)?void 0:o.apiKey);case"chatgpt":return!!((null==(a=t.chatgpt)?void 0:a.apiKey)||(null==(n=t.openai)?void 0:n.apiKey));case"anthropic":return!!(null==(l=t.anthropic)?void 0:l.apiKey);case"gemini":return!!(null==(r=t.gemini)?void 0:r.apiKey);case"deepseek":return!!(null==(i=t.deepseek)?void 0:i.apiKey);case"ollama":return!!(null==(p=t.ollama)?void 0:p.baseUrl)}};async function l(e,t,o){var n,l,r,i,p,s,c,d,m,u,h,g,y,f,v,k,b,O;switch(e){case"openai":case"chatgpt":{let e=(null==(n=t.chatgpt)?void 0:n.apiKey)||(null==(l=t.openai)?void 0:l.apiKey),d=o.messages||[{role:"user",content:o.prompt}],m=o.model||(null==(r=t.chatgpt)?void 0:r.defaultModel)||(null==(i=t.openai)?void 0:i.defaultModel)||"gpt-3.5-turbo";return fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:(0,a._)({"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},(null==(p=t.openai)?void 0:p.org)?{"OpenAI-Organization":t.openai.org}:{}),body:JSON.stringify({model:m,messages:d,temperature:null!=(s=o.temperature)?s:.2,max_tokens:null!=(c=o.max_tokens)?c:256})})}case"anthropic":{let e=null==(d=t.anthropic)?void 0:d.apiKey,a=o.model||(null==(m=t.anthropic)?void 0:m.defaultModel)||"claude-3-opus-20240229",n=(o.messages||[{role:"user",content:o.prompt}]).map(e=>{var t,o;return{role:e.role,content:[{type:"text",text:"string"==typeof e.content?e.content:(null==(o=e.content)||null==(t=o[0])?void 0:t.text)||""}]}});return fetch("https://api.anthropic.com/v1/messages",{method:"POST",headers:{"Content-Type":"application/json","x-api-key":e,"anthropic-version":"2023-06-01"},body:JSON.stringify({model:a,max_tokens:null!=(u=o.max_tokens)?u:256,messages:n})})}case"gemini":{let e=null==(h=t.gemini)?void 0:h.apiKey,a=encodeURIComponent(o.model||(null==(g=t.gemini)?void 0:g.defaultModel)||"gemini-1.5-flash");return fetch("https://generativelanguage.googleapis.com/v1beta/models/".concat(a,":generateContent?key=").concat(encodeURIComponent(e)),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:o.contents||[{parts:[{text:o.prompt}]}]})})}case"deepseek":{let e=null==(y=t.deepseek)?void 0:y.apiKey,a=o.messages||[{role:"user",content:o.prompt}],n=o.model||(null==(f=t.deepseek)?void 0:f.defaultModel)||"deepseek-chat";return fetch("https://api.deepseek.com/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({model:n,messages:a,temperature:null!=(v=o.temperature)?v:.2,max_tokens:null!=(k=o.max_tokens)?k:256})})}case"ollama":{let e=(null==(b=t.ollama)?void 0:b.baseUrl)||"http://localhost:11434";return fetch("".concat(e.replace(/\/$/,""),"/api/generate"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:o.model||(null==(O=t.ollama)?void 0:O.defaultModel)||"llama3.1",prompt:o.prompt,stream:!1})})}}}async function r(e,t,o,n){var l,r,i,p,s,c,d,m,u,h,g,y,f,v,k,b,O;if("openai"===e||"chatgpt"===e||"deepseek"===e){let y="deepseek"===e,f=y?null==(l=t.deepseek)?void 0:l.apiKey:(null==(r=t.chatgpt)?void 0:r.apiKey)||(null==(i=t.openai)?void 0:i.apiKey),v=o.messages||[{role:"user",content:o.prompt}],k=o.model||(y?(null==(p=t.deepseek)?void 0:p.defaultModel)||"deepseek-chat":(null==(s=t.chatgpt)?void 0:s.defaultModel)||(null==(c=t.openai)?void 0:c.defaultModel)||"gpt-3.5-turbo"),b=await fetch("".concat(y?"https://api.deepseek.com":"https://api.openai.com","/v1/chat/completions"),{method:"POST",headers:(0,a._)({"Content-Type":"application/json",Authorization:"Bearer ".concat(f)},"deepseek"!==e&&(null==(d=t.openai)?void 0:d.org)?{"OpenAI-Organization":t.openai.org}:{}),body:JSON.stringify({model:k,messages:v,stream:!0,temperature:null!=(m=o.temperature)?m:.2})});if(!b.ok||!b.body)throw Error("HTTP ".concat(b.status));let O=b.body.getReader(),T="",w=new TextDecoder;for(;;){let{done:e,value:t}=await O.read();if(e)break;let o=(T+=w.decode(t,{stream:!0})).split(/\r?\n/);for(let e of(T=o.pop()||"",o)){let t=e.match(/^data:\s*(.*)$/);if(!t)continue;let o=t[1];if("[DONE]"!==o)try{let e=(null==(g=JSON.parse(o).choices)||null==(h=g[0])||null==(u=h.delta)?void 0:u.content)||"";e&&n(e)}catch(e){}}}return}if("anthropic"===e){let e=null==(y=t.anthropic)?void 0:y.apiKey,a=o.model||(null==(f=t.anthropic)?void 0:f.defaultModel)||"claude-3-opus-20240229",l=(o.messages||[{role:"user",content:o.prompt}]).map(e=>{var t,o;return{role:e.role,content:[{type:"text",text:"string"==typeof e.content?e.content:(null==(o=e.content)||null==(t=o[0])?void 0:t.text)||""}]}}),r=await fetch("https://api.anthropic.com/v1/messages",{method:"POST",headers:{"Content-Type":"application/json","x-api-key":e,"anthropic-version":"2023-06-01"},body:JSON.stringify({model:a,max_tokens:null!=(v=o.max_tokens)?v:256,messages:l,stream:!0})});if(!r.ok||!r.body)throw Error("HTTP ".concat(r.status));let i=r.body.getReader(),p="",s=new TextDecoder;for(;;){let{done:e,value:t}=await i.read();if(e)break;let o=(p+=s.decode(t,{stream:!0})).split(/\r?\n/);for(let e of(p=o.pop()||"",o)){let t=e.match(/^data:\s*(.*)$/);if(!t)continue;let o=t[1];if("[DONE]"!==o)try{let e=JSON.parse(o);"content_block_delta"===e.type&&(null==(k=e.delta)?void 0:k.text)&&n(e.delta.text)}catch(e){}}}return}if("ollama"===e){let e=((null==(b=t.ollama)?void 0:b.baseUrl)||"http://localhost:11434").replace(/\/$/,""),a=await fetch("".concat(e,"/api/generate"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:o.model||(null==(O=t.ollama)?void 0:O.defaultModel)||"llama3.1",prompt:o.prompt,stream:!0})});if(!a.ok||!a.body)throw Error("HTTP ".concat(a.status));let l=a.body.getReader(),r=new TextDecoder,i="";for(;;){let{done:e,value:t}=await l.read();if(e)break;let o=(i+=r.decode(t,{stream:!0})).split(/\r?\n/);for(let e of(i=o.pop()||"",o))try{let t=JSON.parse(e);t.response&&n(t.response)}catch(e){}}return}throw Error("Streaming n\xe3o suportado para este provider")}async function i(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(n(e,t))try{let o={prompt:"ping"};"openai"===e&&(o.model="gpt-3.5-turbo"),"chatgpt"===e&&(o.model="gpt-4o-mini"),"gemini"===e&&(o.model="gemini-1.5-pro"),"deepseek"===e&&(o.model="deepseek-chat"),"ollama"===e&&(o.model="llama3.1");let a=await l(e,t,o),n=(a.headers.get("content-type")||"").includes("application/json")?await a.json():await a.text();return{ok:a.ok,status:a.status,data:n}}catch(e){return{ok:!1,status:0,error:(null==e?void 0:e.message)||"Network error"}}let a="",r={};switch(e){case"openai":a="/api/openai",r={prompt:"ping",model:"gpt-3.5-turbo"};break;case"chatgpt":a="/api/chatgpt",r={prompt:"ping",model:"gpt-4o-mini"};break;case"anthropic":a="/api/claude",r={prompt:"ping"};break;case"gemini":a="/api/gemini",r={prompt:"ping",model:"gemini-1.5-pro"};break;case"deepseek":a="/api/deepseek",r={prompt:"ping",model:"deepseek-chat"};break;case"ollama":a="/api/ollama",r={prompt:"ping",model:"llama3.1"}}let i="".concat(o).concat(a);try{let e=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),t=(e.headers.get("content-type")||"").includes("application/json")?await e.json():await e.text();return{ok:e.ok,status:e.status,data:t}}catch(e){return{ok:!1,status:0,error:"Falha de rede possivelmente por CORS no navegador. Sua chave permanece local e segura."}}}}}]);